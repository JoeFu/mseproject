<!-- /**
* Created by PhpStorm.
* User: Joe Fu
* Date: 1/4/2017
* Time: 11:32 PM
*/ -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../favicon.ico">

    <title>Dashboard</title>

    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="dashboard.css" rel="stylesheet">
    <!--Baidu Echarts JS control-->
    <script src="../js/echarts.js"></script>

	  <link rel="stylesheet" href="../js/jquery-ui.min.css">
	  	  <link rel="stylesheet" href="../js/jquery-ui.structure.min.css">
		  	  <link rel="stylesheet" href="../js/jquery-ui.theme.min.css">
	  	<script type="text/javascript" src="jquery-3.2.1.js"></script>
  <script src="../js/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="../js/jquery-ui-AutoComplete.css">
  <script src="../js/jquery-ui-AutoComplete.js"></script>

</head>

<body>
<nav class="navbar navbar-toggleable-md navbar-inverse fixed-top bg-inverse">
    <button class="navbar-toggler navbar-toggler-right hidden-lg-up" type="button" data-toggle="collapse"
            data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false"
            aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="#">Dashboard</a>

    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Settings</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Profile</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Help</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../index.html">Back</a>
            </li>
        </ul>
        <form class="form-inline mt-2 mt-md-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search">
            <button class="btn btn-info" type="submit">Search</button>

        </form>
    </div>
</nav>

<div class="container-fluid">
    <div class="row">
        <nav class="col-sm-3 col-md-2 hidden-xs-down bg-faded sidebar">
            <ul class="nav nav-pills flex-column">

                <li class="nav-item">
                    <a class="nav-link " href="./index.html">Moodle charts<span class="sr-only">(current)</span></a>
                </li>
				<li class="nav-item">
                    <a class="nav-link" href="MoodleChartsAcrossSemesters.html">Moodle Charts （across semesters)</a>
                </li>
				<li class="nav-item">
                    <a class="nav-link active" href="WebSubmissionCharts.html">WebSubmission charts</a>
                </li>


                <!--<li class="nav-item">
                    <a class="nav-link" href="#">Analytics</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Export</a>
                </li>-->
            </ul>

            <!--<ul class="nav nav-pills flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="#">Nav item</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Nav item again</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">One more nav</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Another nav item</a>
                </li>
            </ul>

            <ul class="nav nav-pills flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="#">Nav item again</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">One more nav</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Another nav item</a>
                </li>
            </ul>-->
        </nav>

        <main class="col-sm-9 offset-sm-3 col-md-10 offset-md-2 pt-3">
            <h1>Dashboard</h1>
				  	<select id="SelectCourse">
						  <option  id="PleaseSelectCourse">Select course</option>

						</select>
						<select id="SelectYear">
						  <option  id="PleaseSelectYear">SelectYear</option>
						</select>
						<select id="SelectSemester">
						  <option  id="PleaseSelectSemester">SelectSemester</option>
						</select>
						<select id="SelectAssignment">
						  <option  id="PleaseSelectAssignment">SelectAssignment</option>
						</select>

<div id="SubmissionTimesOfEachStudent" style="width: 800px;height:400px;"></div>
<div style="width: 200px;height:100px;position: relative;
					  top: -400px;
					  left: 870px;<!--background-color:yellow;-->">

					</div>
    <script type="text/javascript">


$(document).ready(function() {
  
  //Load data for select course
	$.ajax({
		type: "post",
		async: true, 
		url: "LoadCourse.php",
		dataType: "json", 
		success: function(result) {
			//console.log(result);
			var CourseName = [];
			$.each(result,function(i,p){
			  CourseName[i]=p['CourseName'];
			  $("#SelectCourse").append(
              " <option id='" + CourseName[i] + "'>"
              + CourseName[i] + "</option>");
			});
		}
	});

	//When users select course, load options for "select year"
	 $("#SelectCourse").change(function() {
				// When users select course, remove all options in year and semester
				$("#SelectYear option").remove();
				$("#SelectSemester option").remove();
				$("#SelectAssignment option").remove();
				$("#SelectYear").append(
					" <option id='PleaseSelectYear'>SelectYear</option>");
				$("#SelectSemester").append(
					" <option id='PleaseSelectSemester'>SelectSemester</option>");
				$("#SelectAssignment").append(
					" <option id='PleaseSelectAssignment'>SelectAssignment</option>");
				 //Get the course user chooses
				var SelectCourseId=$("#SelectCourse option:selected").attr("id");
				 $.ajax({
					type: "post",
					async: true, 
					url: "LoadYear.php",
					dataType: "json", 
					data: {"SelectCourseId":SelectCourseId},
					success: function(result) {
						var SchoolYear = [];
						$.each(result,function(i,p){
						  SchoolYear[i]=p['SchoolYear'];
						  $("#SelectYear").append(
						  " <option id='" + SchoolYear[i] + "'>"
						  + SchoolYear[i] + "</option>");
						});
					}
				});//ajax
		});//change()

	//When users select course and year, load options for "select semester"
	 $("#SelectYear").change(function() {
				// When users select course and year, remove all options in semester
				$("#SelectSemester option").remove();
				$("#SelectAssignment option").remove();
				$("#SelectSemester").append(
					" <option id='PleaseSelectSemester'>SelectSemester</option>");
				$("#SelectAssignment").append(
					" <option id='PleaseSelectSemester'>SelectAssignment</option>");
				 //Get the course and year user chooses
				var SelectCourseId=$("#SelectCourse option:selected").attr("id");
				var SelectYearId=$("#SelectYear option:selected").attr("id");
				 $.ajax({
					type: "post",
					async: true, 
					url: "LoadSemester.php",
					dataType: "json", 
					data: {"SelectCourseId":SelectCourseId,"SelectYearId":SelectYearId},
					success: function(result) {
						var Semester = [];
						$.each(result,function(i,p){
						  Semester[i]=p['Semester'];
						  $("#SelectSemester").append(
						  " <option id='" + Semester[i] + "'>"
						  + Semester[i] + "</option>");
						});
					}
				});//ajax
		});//change()








	})//DocumentReady()




        // 基于准备好的dom，初始化echarts实例
        var myChartSubmissionTimesOfEachStudent = echarts.init(document.getElementById('SubmissionTimesOfEachStudent'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text: 'Submission Times Of Each Student'
            },
            tooltip: {},
            /*legend: {
                data:['Amount of activities']
            },*/
            xAxis: {
                data: []
            },
            yAxis: {
				name: 'Submission Times'
			},
			dataZoom: [
				{   // 这个dataZoom组件，默认控制x轴。
					type: 'slider', // 这个 dataZoom 组件是 slider 型 dataZoom 组件
					start: 0,      // 左边在 10% 的位置。
					end: 100         // 右边在 60% 的位置。
				}
			],
            series: [{
                name: 'Submission Times',
                type: 'bar',
                data: []
            }],
			toolbox: {
				show: true,
				feature: {
					dataView: {readOnly: false},
					magicType: {type: ['line', 'bar']},
					restore: {},
					saveAsImage: {}
				}
			}
        };

        // 使用刚指定的配置项和数据显示图表。

        myChartSubmissionTimesOfEachStudent.setOption(option);

		function SubmissionTimesOfEachStudent(){
		$.ajax({
			type: "post",
			async: true, //异步执行
			url: "SubmissionTimesOfEachStudent.php",
			dataType: "json", //返回数据形式为json
			success: function(result) {
				console.log(result);
				var FKUserId = [];
				var count = [];
				$.each(result,function(i,p){
				  FKUserId[i]=p['FKUserId'];
				  count[i]=p['count'];
				});
				myChartSubmissionTimesOfEachStudent.hideLoading();
				myChartSubmissionTimesOfEachStudent.setOption({
					xAxis: {
						axisLabel :{
							interval: 'auto', 
							rotate:0
						},
						name: 'User name',
						data: FKUserId
					},

					series: [{
						// 根据名字对应到相应的系列
						name: 'Amount of activities',
						data: count
					}]
				});
			},
			error: function(errorMsg) {
				alert("Retrieving data failure!");
			}
		});
		}

		SubmissionTimesOfEachStudent();

   </script>


   <div id="SubmissionTimeDistribution" style="width: 800px;height:400px;"></div>
<div style="width: 200px;height:100px;position: relative;
					  top: -400px;
					  left: 870px;<!--background-color:yellow;-->">

					</div>
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var myChartSubmissionTimeDistribution = echarts.init(document.getElementById('SubmissionTimeDistribution'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text: 'Submission Time Distribution'
            },
            tooltip: {},
            /*legend: {
                data:['Amount of activities']
            },*/
            xAxis: {
                data: []
            },
            yAxis: {
				name: 'Amount of submission',
			},
			dataZoom: [
				{   // 这个dataZoom组件，默认控制x轴。
					type: 'slider', // 这个 dataZoom 组件是 slider 型 dataZoom 组件
					start: 0,      // 左边在 10% 的位置。
					end: 100         // 右边在 60% 的位置。
				}
			],
            series: [{
                name: 'Amount of submission',
                type: 'bar',
                data: []

            }],
			toolbox: {
				show: true,
				feature: {
					dataView: {readOnly: false},
					magicType: {type: ['line', 'bar']},
					restore: {},
					saveAsImage: {}
				}
			}
        };

        // 使用刚指定的配置项和数据显示图表。

        myChartSubmissionTimeDistribution.setOption(option);

		function SubmissionTimeDistribution(){
		$.ajax({
			type: "post",
			async: true, //异步执行
			url: "SubmissionTimeDistribution.php",
			dataType: "json", //返回数据形式为json
			success: function(result) {
				console.log(result);
				var days = [];
				var count = [];
				$.each(result,function(i,p){
				  days[i]=p['days'];
				  count[i]=p['count'];
				});
				myChartSubmissionTimeDistribution.hideLoading();
				myChartSubmissionTimeDistribution.setOption({
					xAxis: {
						axisLabel :{
							interval: 'auto', 
							rotate:0
						},
						name: 'Day',
						data: days
					},

					series: [{
						// 根据名字对应到相应的系列
						name: 'Amount of submission',
						data: count
					}]
				});
			},
			error: function(errorMsg) {
				alert("Retrieving data failure!");
			}
		});
		}

		SubmissionTimeDistribution();

   </script>

<div id="MarkDistribution" style="width: 800px;height:400px;"></div>
<div style="width: 200px;height:100px;position: relative;
					  top: -400px;
					  left: 870px;<!--background-color:yellow;-->">

					</div>
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var myChartMarkDistribution = echarts.init(document.getElementById('MarkDistribution'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text: 'Mark Distribution'
            },
            tooltip: {},
            /*legend: {
                data:['Amount of activities']
            },*/
            xAxis: {
                data: []
            },
            yAxis: {
				name: 'Number of students'
			},
			dataZoom: [
				{   // 这个dataZoom组件，默认控制x轴。
					type: 'slider', // 这个 dataZoom 组件是 slider 型 dataZoom 组件
					start: 0,      // 左边在 10% 的位置。
					end: 100         // 右边在 60% 的位置。
				}
			],
            series: [{
                name: 'Mark',
                type: 'bar',
                data: []
            }],
			toolbox: {
				show: true,
				feature: {
					dataView: {readOnly: false},
					magicType: {type: ['line', 'bar']},
					restore: {},
					saveAsImage: {}
				}
			}
        };

        // 使用刚指定的配置项和数据显示图表。

        myChartMarkDistribution.setOption(option);

		function MarkDistribution(){
		$.ajax({
			type: "post",
			async: true, //异步执行
			url: "MarkDistribution.php",
			dataType: "json", //返回数据形式为json
			success: function(result) {
				console.log(result);
				var grade = [];
				var count = [];
				$.each(result,function(i,p){
				  grade[i]=p['grade']+"%";
				  count[i]=p['count'];
				});
				myChartMarkDistribution.hideLoading();
				myChartMarkDistribution.setOption({
					xAxis: {
						axisLabel :{
							interval: 'auto', 
							rotate:0
						},
						name: 'Mark',
						data: grade
					},

					series: [{
						// 根据名字对应到相应的系列
						name: 'Number of students',
						data: count
					}]
				});
			},
			error: function(errorMsg) {
				alert("Retrieving data failure!");
			}
		});
		}

		MarkDistribution();

   </script>




        

           </main>
    </div>
</div>

<!-- Footer  -->

<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"
        integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
        crossorigin="anonymous"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/ie10-viewport-bug-workaround.js"></script>
</body>
</html>
